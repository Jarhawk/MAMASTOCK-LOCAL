cd "C:\Users\dark_\Desktop\mamastock.com\MAMASTOCK-LOCAL"

# sauvegarde (si le fichier existe encore)
if (Test-Path .\src-tauri\tauri.conf.json) {
  Copy-Item .\src-tauri\tauri.conf.json .\src-tauri\tauri.conf.json.bak -Force
}

# réécrit une config Tauri v2 minimale, SANS commentaires et bien formattée
@'
{
  "$schema": "https://schema.tauri.app/config/2",
  "productName": "MAMASTOCK",
  "version": "0.1.0",
  "identifier": "com.mamastock.local",

  "build": {
    "beforeBuildCommand": "npm run build",
    "frontendDist": "../dist"
  },

  "app": {
    "security": { "csp": null },
    "windows": [
      { "title": "MAMASTOCK", "width": 1280, "height": 800, "resizable": true }
    ]
  },

  "bundle": {
    "active": true,
    "targets": ["nsis", "msi"],
    "icon": [
      "icons/icon.ico",
      "icons/256x256.png",
      "icons/512x512.png",
      "icons/1024x1024.png"
    ],
    "resources": [
      "installer/config.json",
      "installer/nsis/**",
      "installer/wix/**"
    ],
    "windows": {
      "wix": {
        "bannerPath": "installer/wix/banner.bmp",
        "dialogImagePath": "installer/wix/dialog.bmp",
        "template": "installer/wix/main.wxs"
      },
      "nsis": {
        "template": "installer/nsis/tauri.nsis",
        "headerImage": "installer/nsis/header.bmp",
        "sidebarImage": "installer/nsis/sidebar.bmp",
        "displayLanguageSelector": true
      }
    }
  }
}
'@ | Set-Content -Encoding utf8 "src-tauri\tauri.conf.json"
