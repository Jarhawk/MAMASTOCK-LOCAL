<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <Product
    Id="*"
    Name="MAMASTOCK"
    Language="!(loc.ProductLanguage)"
    Version="0.1.0"
    Manufacturer="Quentin Vanel"
    UpgradeCode="{B035F2E7-24E4-4486-A2EB-956DB8291C23}"
  >
    <Package InstallerVersion="500" Compressed="yes" InstallScope="perMachine" />
    <Media Id="1" Cabinet="product.cab" EmbedCab="yes" />
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Icon Id="AppIcon" SourceFile="src-tauri\\icons\\icon.ico" />
    <Property Id="ARPPRODUCTICON" Value="AppIcon" />
    <Property Id="ARPCONTACT" Value="Quentin Vanel" />
    <Property Id="ARPHELPLINK" Value="mailto:quentinvanel@gmail.com" />
    <Property Id="ARPURLINFOABOUT" Value="mailto:quentinvanel@gmail.com" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="!(loc.ExitCheckboxText)" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALTEXT" Value="!(loc.ExitDialogText)" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX" Value="1" />
    <Property Id="WixShellExecTarget" Value="[INSTALLFOLDER]MAMASTOCK.exe" />

    <CustomAction
      Id="LaunchApplication"
      BinaryKey="WixCA"
      DllEntry="WixShellExec"
      Impersonate="yes"
      Return="asyncNoWait"
    />

    <UI>
      <UIRef Id="WixUI_InstallDir" />
      <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">
        WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1
      </Publish>
    </UI>

    \ \ <WixVariable\ Id="WixUIBannerBmp"\ Value="banner\.bmp"\ />
    \ \ <WixVariable\ Id="WixUIDialogBmp"\ Value="dialog\.bmp"\ />
    \ \ <WixVariable\ Id="WixUILicenseRtf"\ Value="license-fr\.rtf"\ />

    <SummaryInformation Description="!(loc.ProductTagline)" Manufacturer="Quentin Vanel" />

    <!-- Tauri will generate component and files in a separate fragment -->
  </Product>

  <Fragment>
    <DirectoryRef Id="ProgramDataFolder">
      <Directory Id="DIR_MAMASTOCK_PD" Name="MAMASTOCK">
        <Component Id="CMP_ConfigJson" Guid="*">
          <File Id="FIL_ConfigJson"
                Name="config.json"
                Source="$(var.ProjectDir)src-tauri\installer\config.json"
                Vital="yes"
                KeyPath="yes"
                NeverOverwrite="yes" />
        </Component>
      </Directory>
    </DirectoryRef>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents">
      <ComponentRef Id="CMP_ConfigJson" />
    </ComponentGroup>
  </Fragment>
</Wix>

